/* --- Modern Dark Theme (Responsive & Sticky Footer) --- */

/* Universal Box Sizing */
* {
    box-sizing: border-box;
}

/* 1. Basic Reset and Font */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background-color: #1e1e1e;
    color: #e0e0e0;
    margin: 0;
    -webkit-font-smoothing: antialiased;
}

/* ** MODIFIED: Use Small Viewport Height (svh) to fix footer overlap ** */
#app-container {
    width: 100%;
    height: 100svh; /* This is the key change */
    background-color: #1e1e1e;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* 2. Navigation */
nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #333;
    background-color: #2a2a2a;
    padding-right: 10px;
    padding-left: env(safe-area-inset-left);
    padding-right: calc(10px + env(safe-area-inset-right));
}
.nav-tabs { display: flex; flex-grow: 1; }
.nav-btn {
    padding: 15px; border: none; background-color: transparent; color: #a0a0a0; font-size: 16px; cursor: pointer;
    transition: color 0.2s, background-color 0.2s; flex-grow: 1;
}
.nav-btn.active { background-color: #1e1e1e; border-bottom: 2px solid #4CAF50; color: #ffffff; font-weight: 600; }
.nav-actions { display: flex; align-items: center; gap: 5px; }

/* Actions Menu */
#actions-menu-container { position: relative; }
#actions-menu-btn { background: none; border: none; color: #ccc; cursor: pointer; padding: 8px; border-radius: 50%; display: flex; align-items: center; }
#actions-menu-btn:hover { background-color: #444; }
#actions-dropdown { position: absolute; right: 0; top: calc(100% + 5px); background-color: #333; border: 1px solid #444; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.5); z-index: 20; overflow: hidden; transition: transform 0.1s ease-out, opacity 0.1s ease-out; }
#actions-dropdown.hidden { transform: scale(0.95); opacity: 0; pointer-events: none; }
#actions-dropdown button { display: block; width: 100%; padding: 12px 20px; background: none; border: none; color: #e0e0e0; text-align: left; cursor: pointer; }
#actions-dropdown button:hover { background-color: #4CAF50; color: white; }


/* 3. Page Management */
.page {
    display: none;
    flex-direction: column;
    flex-grow: 1;
    overflow: hidden;
}
.page.active {
    display: flex;
}

main {
    padding: 15px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* 4. Forms, Inputs & Buttons */
form { display: flex; flex-direction: column; gap: 12px; margin-bottom: 15px; }
.inputs-row { display: flex; gap: 12px; }
input[type="text"], input[type="number"], select { width: 100%; flex: 1; padding: 12px; border: 1px solid #444; background-color: #2a2a2a; color: #e0e0e0; border-radius: 8px; font-size: 14px; }
input::placeholder { color: #777; }
select { appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23cccccc%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsolution%3E'); background-repeat: no-repeat; background-position: right 1rem center; background-size: .8em; padding-right: 2.5rem; }

.btn-primary { width: 100%; padding: 12px; border: none; border-radius: 8px; background-color: #4CAF50; color: white; font-size: 15px; font-weight: 600; cursor: pointer; transition: background-color 0.2s; }
.btn-primary:hover { background-color: #5cc960; }
.btn-secondary { width: 100%; padding: 12px; border: 1px solid #555; background-color: transparent; color: #ccc; font-size: 15px; font-weight: 600; border-radius: 8px; cursor: pointer; transition: background-color 0.2s; }
.btn-secondary:hover { background-color: #333; }

/* 5. Autocomplete */
.autocomplete-container { position: relative; }
#autocomplete-results { position: absolute; top: 100%; left: 0; right: 0; background: #2a2a2a; border: 1px solid #444; border-top: none; border-radius: 0 0 8px 8px; z-index: 10; max-height: 150px; overflow-y: auto; }
.autocomplete-item { padding: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
.autocomplete-item:hover { background-color: #4CAF50; color: white; }
.autocomplete-item .stats { font-size: 0.8em; color: #aaa; }
.autocomplete-item:hover .stats { color: white; }

/* 6. Lists, Totals & Headers */
.section-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; margin-bottom: 10px; }
h2 { color: #ffffff; padding-bottom: 8px; margin-bottom: 0; border-bottom: none; }
h3 { margin-top: 0; color: #eee; }
#totals { background-color: #2a2a2a; padding: 15px; border-radius: 8px; margin-bottom: 15px; }
.meal-header {
    background-color: #2a2a2a; padding: 8px 15px; margin: 15px -15px 5px -15px; font-weight: 600; color: #4CAF50;
    display: flex; justify-content: space-between; align-items: center;
}
.meal-subtotal { font-size: 0.8em; color: #aaa; font-weight: normal; }

.scrollable-list-container {
    flex-grow: 1;
    overflow-y: auto;
    padding-bottom: 10px;
}
.food-item, .db-food-item { padding: 12px 5px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }

.sort-container { display: flex; align-items: center; gap: 8px; }
.sort-container label { font-size: 0.9em; color: #aaa; }
.sort-container select { width: auto; flex-grow: 1; font-size: 12px; padding: 8px 12px; }

/* Goal Progress Bars */
.goal-stat { margin-bottom: 15px; }
.goal-stat:last-child { margin-bottom: 0; }
.goal-label { display: flex; justify-content: space-between; font-size: 0.9em; margin-bottom: 6px; color: #ccc; }
.progress-bar-background { background-color: #444; height: 10px; border-radius: 5px; overflow: hidden; }
.progress-bar-fill { background-color: #4CAF50; height: 100%; width: 0%; border-radius: 5px; transition: width 0.5s ease-out; }

/* 7. Action Buttons */
.item-actions { display: flex; gap: 8px; }
.item-action-btn {
    background-color: #444; color: #ccc; border: none; padding: 6px 12px; border-radius: 6px;
    cursor: pointer; transition: background-color 0.2s; font-size: 12px; font-weight: 600;
}
.edit-btn:hover { background-color: #2980b9; color: white; }
.delete-btn:hover { background-color: #e74c3c; color: white; }
.text-btn { background: none; border: none; color: #4CAF50; cursor: pointer; font-size: 14px; font-weight: 600; }

/* 8. Footers */
#tracker-footer { 
    padding: 10px 15px; 
    background-color: #2a2a2a; 
    border-top: 1px solid #333; 
    padding-bottom: calc(10px + env(safe-area-inset-bottom));
}
#date-nav { display: flex; justify-content: space-between; align-items: center; }
#date-nav button { background: none; border: none; color: #4CAF50; font-size: 22px; cursor: pointer; }
#today-btn { font-size: 14px; color: #ccc; padding: 4px 8px; border: 1px solid #555; border-radius: 5px; }
#current-date-display { color: #fff; font-weight: 600; }

/* 9. Reports Page */
.chart-container { position: relative; height: 250px; width: 100%; margin-bottom: 25px; }
#reports-summary { background-color: #2a2a2a; padding: 15px; border-radius: 8px; }
#reports-summary h3 { margin-top: 0; color: #4CAF50; }
#reports-summary p { margin: 10px 0; display: flex; justify-content: space-between; font-size: 1.1em; }
#reports-summary span:last-child { font-weight: 600; }

/* 10. Settings Modal */
#settings-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; display: flex; align-items: center; justify-content: center; }
#settings-modal.hidden { display: none; }
.modal-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); }
.modal-content { position: relative; z-index: 101; background-color: #2a2a2a; padding: 25px; border-radius: 12px; width: 90%; max-width: 400px; }
.modal-content form { margin-bottom: 0; }
.modal-content label { margin-bottom: 5px; font-size: 0.9em; color: #ccc; }
.modal-actions { display: flex; gap: 10px; margin-top: 20px; }

/* Hide arrows from number inputs */
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
input[type=number] {
  -moz-appearance: textfield;
}